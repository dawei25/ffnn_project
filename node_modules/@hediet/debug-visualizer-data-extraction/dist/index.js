module.exports=function(t){var e={};function r(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(o,i,function(e){return t[e]}.bind(null,i));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=8)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.expect=function(t){return t}},function(t,e,r){"use strict";function o(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),o(r(7)),o(r(17)),o(r(18)),o(r(19)),o(r(20)),o(r(21)),o(r(22))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(3));var o=r(4);e.DataExtractorApiImpl=o.DataExtractorApiImpl},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(4),i=r(1),n=r(27);e.getExpressionToInitializeDataExtractorApi=function(){return`((function () {\n\t\tlet module = {};\n\t\t${r(28).readFileSync(__filename,{encoding:"utf8"})}\n\t\treturn module.exports.getDataExtractorApi();\n\t})())`},e.getExpressionForDataExtractorApi=function(){return`((${c.toString()})())`},e.getExpressionToDetectDataExtractorApiPresence=function(){return`((${s.toString()})())`};const a="@hediet/data-extractor-api/v2";function s(){return void 0!==("object"==typeof window?window:global)["@hediet/data-extractor-api/v2"]}function c(){let t=("object"==typeof window?window:global)["@hediet/data-extractor-api/v2"];if(!t)throw new Error("Data Extractor API has not been initialized.");return t}function u(){("object"==typeof window?window:global).hedietDbgVis={...i,...n}}e.getDataExtractorApi=function(){u();const t="object"==typeof window?window:global;return t[a]||(t[a]=new o.DataExtractorApiImpl),t[a]},e.installHelpers=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(5);class i{constructor(){this.extractors=new Map}toJson(t){return JSON.stringify(t)}registerExtractor(t){this.extractors.set(t.id,t)}registerExtractors(t){for(const e of t)this.registerExtractor(e)}getData(t,e,r,o){const n=new Array,a={addExtraction(t){n.push(t)}};i.lastVariablesInScope=o,i.lastEvalFn=e;const s=t();for(const t of this.extractors.values())t.getExtractions(s,a,{evalFn:e,variablesInScope:o});i.lastVariablesInScope=void 0,i.lastEvalFn=void 0,n.sort((t,e)=>e.priority-t.priority);let c=n[0];if(!c)return this.toJson({kind:"NoExtractors"});if(r){const t=n.find(t=>t.id===r);t&&(c=t)}function u(t){return{id:t.id,name:t.name,priority:t.priority}}const l=c.extractData();return this.toJson({kind:"Data",extractionResult:{data:l,usedExtractor:u(c),availableExtractors:n.map(u)}})}registerDefaultExtractors(t=!1){o.registerDefaultExtractors(this)}}e.DataExtractorApiImpl=i,i.lastVariablesInScope=void 0},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r(10);e.registerDefaultExtractors=o.registerDefaultExtractors},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isVisualizationData=function(t){if(!("object"==typeof t&&t&&"kind"in t))return!1;const e=t;return!("object"!=typeof e.kind||!e.kind)&&Object.values(e.kind).every(t=>!0===t)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createGraph=function(t,e,r={}){const o={kind:{graph:!0},nodes:[],edges:[]};let i=1;const n=new Map;function a(t){const r=e(t).id;if(void 0!==r)return""+r;let o=n.get(t);return o||(o=`hediet.de/id-${i++}`,n.set(t,o)),o}const s=new Array(...t.map(t=>({item:t,dist:0}))),c=new Set;for(;s.length>0;){const{item:t,dist:i}=s.shift();if(c.has(t))continue;c.add(t);const n=e(t),u=a(t);o.nodes.push({...n,id:u,edges:void 0});for(const t of n.edges){let e,n,l;if("to"in t)e=t.to,n=a(t.to),l=u;else if("from"in t)e=t.from,n=a(t.from),l=u;else{if(!("include"in t))throw new Error("Every edge must either have 'to' or 'from'");e=t.include}void 0!==l&&void 0!==n&&o.edges.push({...t,from:l,to:n});let d=!c.has(e);r.maxSize&&c.size+s.length>r.maxSize&&(d=!1),d&&s.push({item:e,dist:i+1})}}return o}},function(t,e,r){"use strict";function o(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),o(r(9)),o(r(6))},function(t,e,r){"use strict";function o(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),o(r(2)),o(r(1));var i=r(5);e.registerDefaultExtractors=i.registerDefaultExtractors},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(11),i=r(12),n=r(13),a=r(14),s=r(15),c=r(16),u=r(3),l=r(23),d=r(24),f=r(25),p=r(26);e.registerDefaultExtractors=function(t=u.getDataExtractorApi()){for(const e of[new o.TypeScriptAstDataExtractor,new i.AsIsDataExtractor,new n.GetVisualizationDataExtractor,new a.ToStringDataExtractor,new s.PlotlyDataExtractor,new c.ObjectGraphExtractor,new l.GridExtractor,new d.TableDataExtractor,new f.StringDiffExtractor,new p.InjectedExtractor])t.registerExtractor(e)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(0);e.TypeScriptAstDataExtractor=class{constructor(){this.id="typescript-ast"}getExtractions(t,e,{evalFn:r}){if(!t)return;let n;try{if(n="object"==typeof t&&"typescript"in t?t.typescript:r("require")("typescript"),!n)return}catch(t){return}const a=new i(n);let s,c=void 0,u=void 0,l=t=>{};if(Array.isArray(t)&&t.every(a.isNode)&&t.length>0)c=a.getSourceFile(t[0]),s=new Set(t);else if(a.isNode(t))c=a.getSourceFile(t),s=new Set([t]);else{if("object"!=typeof t||!t)return;{s=new Set;const e=new Map;l=t=>e.get(t);for(const[r,o]of Object.entries(t))if("fn"===r)l=o;else if("typescript"===r);else{let t;if("rootNode"===r&&(u=o),a.isNode(o))t=[o];else{if(!Array.isArray(o)||!o.every(a.isNode))return;t=o}t.length>0&&!c&&(c=a.getSourceFile(t[0]));for(const o of t)s.add(o),e.set(o,r)}}}if(!c)return;const d=c;e.addExtraction({id:"ts-ast",name:"TypeScript AST",priority:1e3,extractData:()=>o.expect({kind:{text:!0,tree:!0,ast:!0},root:a.toTreeNode(u||d,"root","",s,l),text:d.text,fileName:"index.ts"})})}};class i{constructor(t){this.tsApi=t,this.isNode=t=>"object"==typeof t&&null!==t&&(this.tsApi.isToken(t)||this.tsApi.isNode(t))}getPropertyNameInParent(t,e){for(const r in e){if(r.startsWith("_"))continue;const o=e[r];if(o===t)return r;if(Array.isArray(o)){const e=o.indexOf(t);if(-1!==e)return`${r}[${e}]`}}}getChildren(t){const e=new Array;return this.tsApi.forEachChild(t,t=>{e.push(t)}),e}toTreeNode(t,e,r,o,i){const n=this.tsApi.SyntaxKind[t.kind],a=this.getChildren(t).map((e,r)=>{let n=this.getPropertyNameInParent(e,t)||"";if(e.kind==this.tsApi.SyntaxKind.SyntaxList){const r=this.getChildren(e);for(const e of r){const r=this.getPropertyNameInParent(e,t)||"";if(r){n=r;break}}}let a="."+n;return t.kind==this.tsApi.SyntaxKind.SyntaxList&&(n=""+r,a=`[${r}]`),this.toTreeNode(e,n,a,o,i)}).filter(t=>null!==t);let s=void 0;this.tsApi.isIdentifier(t)?s=t.text||t.escapedText:this.tsApi.isLiteralExpression(t)&&(s=t.text);const c=[{text:`${e}: `,emphasis:"style1"},{text:n}],u=i(t);return s&&c.push({text:s,emphasis:"style2"}),u&&c.push({text:u,emphasis:"style3"}),{items:c,children:a,segment:r,span:{length:t.end-t.pos,start:t.pos},isMarked:o.has(t)}}getSourceFile(t){if(!t)throw new Error("Detached node");return this.tsApi.isSourceFile(t)?t:"getSourceFile"in t?t.getSourceFile():this.getSourceFile(t.parent)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(6);e.AsIsDataExtractor=class{constructor(){this.id="as-is"}getExtractions(t,e,r){o.isVisualizationData(t)&&e.addExtraction({id:this.id,name:"As Is",priority:500,extractData:()=>t})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.GetVisualizationDataExtractor=class{constructor(){this.id="get-visualization-data"}getExtractions(t,e,r){if("object"!=typeof t||!t)return;const o=t.getVisualizationData;"function"==typeof o&&e.addExtraction({id:this.id,name:"Use Method 'getVisualizationData'",priority:600,extractData:()=>o.apply(t)})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(0);e.ToStringDataExtractor=class{constructor(){this.id="to-string"}getExtractions(t,e,r){e.addExtraction({id:"to-string",name:"To String",priority:100,extractData:()=>o.expect({kind:{text:!0},text:""+t})})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(0);e.PlotlyDataExtractor=class{constructor(){this.id="plot"}getExtractions(t,e,r){Array.isArray(t)&&(t.some(t=>"number"!=typeof t)||e.addExtraction({id:"plot-y",name:"Plot as y-Values",priority:1001,extractData:()=>o.expect({kind:{plotly:!0},data:[{y:t}]})}))}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(1);e.ObjectGraphExtractor=class{constructor(){this.id="object-graph"}getExtractions(t,e,r){function i(t){return"object"==typeof t&&!!t}i(t)&&e.addExtraction({id:"object-graph",name:"Object Graph",priority:99,extractData:()=>o.createGraph([t],e=>{let r="";const o=new Array;if(e instanceof Set){r="Set";for(const t of e.values())i(t)&&o.push({label:"item",to:t})}else if(e instanceof Map){r="Map";for(const[t,r]of e.entries())i(r)&&o.push({label:t,to:r})}else{for(const[t,r]of Object.entries(e))i(r)&&o.push({label:t,to:r});r=e.constructor?e.constructor.name:"?"}return{shape:"box",edges:o,color:e===t?"lightblue":void 0,label:r}},{maxSize:50})})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(7);e.createGraphFromPointers=function(t,e){const r={},i=Object.entries(t).map(([t,e])=>({marker:r,name:t,value:e}));return o.createGraph(i,t=>"marker"in t&&t.marker===r?{id:"label____"+t.name,color:"orange",label:t.name,edges:[{to:t.value,color:"orange",label:""}].filter(t=>!!t.to)}:e(t))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(4);e.tryEval=function(t){const e={},r=o.DataExtractorApiImpl.lastEvalFn;if(Array.isArray(t))for(const o of t)try{e[o]=r(o)}catch(t){}else for(const[o,i]of Object.entries(t))try{e[o]=r(i)}catch(t){}return e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.markedGrid=function(t,e){return{kind:{grid:!0},rows:[{columns:t.map(t=>({content:""+t,tag:""+t}))}],markers:Object.entries(e).map(([t,e])=>({id:""+t,row:0,column:e})).filter(t=>void 0!==t.column)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(2),i=new Map;e.cache=function(t,e){let r,n;if("string"==typeof t){const i=o.DataExtractorApiImpl.lastEvalFn;r=()=>i(t),n=JSON.stringify({expr:t,id:e})}else r=()=>t(),n=JSON.stringify({expr:t.toString(),id:e});if(i.has(n))return i.get(n);const a=r();return i.set(n,a),a}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.asData=function(t){return t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(2);e.find=function(t){const e=new Set;if(!o.DataExtractorApiImpl.lastVariablesInScope)throw new Error("No variables in scope!");const r=[...Object.values(o.DataExtractorApiImpl.lastVariablesInScope)];let i=1e4;for(;i>0;){i--;const o=r.shift();if(e.add(o),t(o))return o;if("object"==typeof o&&o)for(const t of Object.values(o))e.has(t)||(e.add(t),r.push(t))}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(0);e.GridExtractor=class{constructor(){this.id="grid"}getExtractions(t,e,r){Array.isArray(t)&&e.addExtraction({id:this.id,name:"Array As Grid",priority:500,extractData:()=>o.expect({kind:{grid:!0},rows:[{columns:t.map(t=>({tag:""+t}))}]})})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(0);e.TableDataExtractor=class{constructor(){this.id="table"}getExtractions(t,e,r){Array.isArray(t)&&t.every(t=>"object"==typeof t&&t)&&(e.addExtraction({id:"table",name:"Table",priority:1e3,extractData:()=>o.expect({kind:{table:!0},rows:t})}),e.addExtraction({id:"table-with-type-name",name:"Table (With Type Name)",priority:950,extractData:()=>o.expect({kind:{table:!0},rows:t.map(t=>({type:t.constructor.name,...t}))})}))}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.StringDiffExtractor=class{constructor(){this.id="string-diff"}getExtractions(t,e,r){Array.isArray(t)&&2===t.length&&"string"==typeof t[0]&&"string"==typeof t[1]&&e.addExtraction({id:"string-diff",name:"String Diff",priority:1e3,extractData:()=>({kind:{text:!0},text:t[0],otherText:t[1]})})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=r(1);e.InjectedExtractor=class{constructor(){this.id="injected-extractor"}getExtractions(t,e,r){const i=Object.values(global["@hediet/debug-visualizer/injectedScripts"]),n=new Array;for(const t of i)t(t=>{n.push(t)},o);for(const o of n)o.getExtractions(t,e,r)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r(3);e.getApi=o.getDataExtractorApi},function(t,e){t.exports=require("fs")}]);
//# sourceMappingURL=index.js.map